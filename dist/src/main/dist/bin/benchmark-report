#!/bin/bash

if [ -z "${SIMULATOR_HOME}" ] ; then
    export SIMULATOR_HOME=$(cd $(dirname $(readlink -f $0 2> /dev/null || readlink $0 2> /dev/null || echo $0))/.. && pwd)
fi

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

export SIMULATOR_HOME=$(cd $DIR/.. && pwd)

 # Check if python is installed.
if ! hash python 2>/dev/null ; then
    echo python is not installed! Aborting.
    exit 1
fi

 # Check if gnuplot is installed.
if ! hash gnuplot 2>/dev/null ; then
    echo gnuplot is not installed! Aborting.

    os=$(uname)
    if [[ $os == *"arwin"* ]]
    then
        echo gnuplot is available on OSX using homebrew: http://brewformulas.org/gnuplot
        echo To install gnuplot using homebrew type: 'brew install gnuplot'
    fi

    exit 1
fi

 # Check if pip and yattag module is installed on system.
if ! hash pip 2>/dev/null ; 
then
    echo pip is not installed! Aborting.
    exit 1
else
    echo Installing yattag...

    # Install yattag package 
    pip install yattag

    # Check if yattag gets installed
    yattag=$(pip list | grep -F yattag)
    if [ -z $yattag ] ; then
        echo pip could not install yattag package.
        echo To install yattag using pip, type: 'pip install yattag'
        echo For more details, refer: https://www.yattag.org/download-install 
    fi 
fi

python ${SIMULATOR_HOME}/conf/benchmark-report.py "$@"
